<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8">

	<title>Lean and AI</title>

	<meta name="description" content="Kaapi with Kuriosity lecture">
	<meta name="author" content="Siddhartha Gadgil">

	<meta name="apple-mobile-web-app-capable" content="yes" />
	<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

	<meta name="viewport"
		content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

	<link rel="stylesheet" href="css/reveal.css">
	<link rel="stylesheet" href="css/theme/black.css" id="theme">

	<!-- Code syntax highlighting -->
	<link rel="stylesheet" href="lib/css/zenburn.css">
	<link rel="stylesheet" href="pg.css">

	<link rel="icon" href="IIScLogo.jpg">

	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@5.0.5/dist/reset.css" />
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@5.0.5/dist/reveal.css" />
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@5.0.5/dist/theme/black.css" id="theme" />

	<!-- Printing and PDF exports -->
	<script>
		var link = document.createElement('link');
		link.rel = 'stylesheet';
		link.type = 'text/css';
		link.href = window.location.search.match(/print-pdf/gi) ? 'css/print/pdf.css' : 'css/print/paper.css';
		document.getElementsByTagName('head')[0].appendChild(link);
	</script>

	<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
</head>

<body>

	<div class="reveal">

		<!-- Any section element inside of this container is displayed as a slide -->
		<section class="slides">
			<section data-transition="slide">
				<strong class="larger">ProvingGround: </strong>
				<h3> towards Automating Mathematics? </h3>
				<h4>Siddhartha Gadgil</h4>
				<p>Department of Mathematics</p>
				<p>Indian Institute of Science</p>
				<p>Bangalore</p>
				<p><a href="http://math.iisc.ac.in/~gadgil/">http://math.iisc.ac.in/~gadgil/</a></p>
				<p><a href="https://github.com/siddhartha-gadgil/ProvingGround"
						target="_blank">https://github.com/siddhartha-gadgil/ProvingGround</a></p>


			</section>

			<section data-transition="zoom-in fade-out">
				<h3>Automating Mathematics?</h3>
				<ul>
					<li>
						Can computers acquire <strong>all the major capabilities</strong> used by mathematicians and the
						mathematics community in the <strong>discovery</strong> and <strong>proof</strong> of
						mathematical results and concepts?
					</li>
					<li>When? <strong>How?</strong></li>
				</ul>
			</section>

			<section data-transition="zoom-in fade-out">
				<ul>
					<li>I began my research in <em>low-dimensional topology</em>, doing a Ph.D. at
						<strong>Caltech</strong>
						(advisor: David Gabai).
					</li>
					<li>For the next 10-15 years, I mainly worked in
						low-dimensional topology and related fields such as <em>geometric group theory</em> and
						<em>riemannian geometry</em>.
					</li>
					<li>However, for the last few years I have mainly focussed on attempts at <em>Automated Theorem
							Proving</em>.</li>
					<li>Surprisingly both these strands came together in the <em>PolyMath adventure.</em></li>
				</ul>
			</section>

			<section data-transition="convex" data-background-color="teal">
				<h3>The PolyMath 14 participants</h3>
				<ul>
					<li>Tobias Fritz, MPI MIS</li>
					<li> Siddhartha Gadgil, IISc, Bangalore </li>
					<li> Apoorva Khare, IISc, Bangalore</li>
					<li> Pace Nielsen, BYU </li>
					<li> Lior Silberman, UBC </li>
					<li> Terence Tao, UCLA </li>
				</ul>

			</section>

			<section data-transition="convex" data-background-color="teal">
				<ul>
					<li>On Saturday, December 16, 2017, Terrence Tao posted on his blog a question, which Apoorva Khare
						had asked him.</li>
					<blockquote>
						Is there a homogeneous, (conjugacy invariant) length function on the free group on two
						generators?
					</blockquote>
					<li>Six days later, this was answered in a collaboration involving several
						mathematicians (and a computer).</li>
					<li>We begin with an account of this episode.</li>
				</ul>
			</section>

			<section data-transition="convex" data-background-color="teal">
				<ul>
					<li>Let $\mathcal{W}$ be the set of finite words in the alphabet $\{\alpha, \beta, \bar\alpha,
						\bar\beta\}$,
						with multiplication given by concatenation and $e$ the empty word.
					</li>
					<li>
						<strong>Question:</strong> Is there a non-negative, real-valued function $l$ on $\mathcal{W}$
						such that for $g, h\in\mathcal{W}$,
						<ol>
							<li>$l(e) =0$,</li>
							<li>$l(g\cdot\lambda\bar\lambda\cdot h) = l(g\cdot h) = l(g\cdot\bar\lambda\lambda\cdot h)$,
								for $\lambda=\alpha,\beta$ <strong>($l$ defined on the free group)</strong>,</li>
							<li>$l(g\cdot h)\leq l(g) + l(h)$ <strong>(triangle inequality)</strong>,</li>
							<li>if $l(g) = 0$ then $g\sim e$ <strong>(positivity)</strong>,</li>
							<li>$l(g^n)=nl(g)$, <strong>(homogeneity)</strong>?</li>
						</ol>
					</li>
					<li><em>Pseudo-lengths</em> satisfy 1 &ndash; 3, <em>lengths</em> satisfy 1 &ndash; 4.</li>
				</ul>
			</section>

			<section data-transition="convex" data-background-color="teal">
				<ul>
					<li>Over the first 4-5 days after the question was posted,
						<ul>
							<li>there were many (failed, but instructive) attempts to construct such length functions;
							</li>
							<li>in particular I focussed on a construction using <em>non-crossing matchings</em>,
								but this was not homogeneous;</li>
							<li>the failures of various constructions led to the feeling that
								$l(\alpha\beta\bar\alpha\bar\beta) = 0$ for homogeneous pseudo-lengths, which violates
								positivity.</li>
						</ul>
					</li>
				</ul>
			</section>

			<section data-transition="convex" data-background-color="teal">
				<ul>
					<li>Increasingly sharp bounds and methods of combining bounds were found.</li>
					<li>But there was no visible path to proving $l(\alpha\beta\bar\alpha\bar\beta) = 0$.</li>
					<li>I searched for bounds using an algorithm to calculate the non-crossing
						matchings length,
						together with interactive use of homogeneity.
					</li>
					<li>On Thursday morning, I posted a <strong>computer generated, human readable</strong> proof of a
						bound, obtained by upgrading the algorithms to find <strong>proofs</strong> rather than just
						numbers.</li>
				</ul>
			</section>

			<section data-background-iframe="pg-gross-proof.html"></section>

			<section data-transition="convex" data-background-color="teal">
				<ul>
					<li>The computer-generated proof was studied by Pace Nielsen, who extracted the <em>internal
							repetition</em> trick. </li>
					<li>This was extended by Pace Nielsen and Tobias Fritz and abstracted by Terence Tao.
					</li>
					<li>From this Fritz obtained a key lemma.</li>
					<li>Using Probability, Terence Tao completed the proof of a result answering the question.</li>
					<li>This work became <strong>PolyMath 14</strong>, and has been published in <em>Algebra & Number
							Theory</em>.</li>
				</ul>
			</section>
			<section data-transition="convex" data-background-color="teal">
				<ul>
					<li>The computer generated proof was obtained by an algorithm using <em>domain specific
							foundations</em>. </li>
					<li>Subsequently, we embedded the foundations we used to generate the proofs and formalized the
						internal repetition trick in <strong>ProvingGround</strong>.</li>
					<li>An account of the computer proof was published in the <em>Journal of Automated reasoning</em>.
					</li>
					<li>In response to the referees comments we replicated the computer proof
						(and also addressed the issue of rounding off errors).</li>
					<li>In the future, all parts should perhaps be done with the <em>Lean Theorem Prover</em>.</li>
				</ul>
			</section>

			<section data-transition="zoom-in concave-out" data-background-image="campus.jpg">
				<p><strong class="larger">ProvingGround:</strong></p>
				<p><strong class="larger">Foundations, Formal Proofs</strong></p>
			</section>

			<section data-background-color="teal">
				<h4>LeanAide: Autoformalization of statements</h4>
				<ul>
					<li class="fragment">Our tool <strong>LeanAide</strong> uses GPT-4 to translate
						statements (similar to docstrings) into Lean 4 code.</li>
					<li class="fragment">We do prompt engineering and post-processing.</li>
					<li class="fragment">Lean 4 is written (mostly) in Lean 4, and has convenient functions
						for using its interpreter, greatly facilitating our post-processing.</li>
					<li class="fragment">LeanAide is integrated with the user-interface of Lean 4 via code actions.</li>
				</ul>
			</section>

			<section data-background-video="leanaide-jan24.webm" data-background-video-muted> </section>

			<section data-background-color="teal">
				<h4>LeanAide: Prompting & Post-processing</h4>
				<ul>
					<li class="fragment">Suppose we are given the statement of a theorem.</li>
					<li class="fragment">We find (say) 20 documentation strings in Lean's mathematical library
						<em>Mathlib</em>
						that are closest to the statement (for OpenAI embeddings) and include them in the prompt.
					</li>
					<li class="fragment">We query GPT-4 with the prompt for (say) 10
						responses.</li>
					<li class="fragment">We discard responses that are not valid Lean code (do not parse or do not
						elaborate).</li>
				</ul>
			</section>

			<section data-background-color="teal">
				<ul>
					<li>If a vector space is $2$-dimensional, then it is finite dimensional.
						<pre><code data-trim data-noescape class="language-json">
								[{"role": "system",
								"content": "You are a coding assistant who translates from natural language to Lean
								Theorem Prover code following examples. Follow EXACTLY the examples given."},
								{"role": "user",
								"content": "If a vector space has a finite basis, then it is finite-dimensional. "},
								{"role": "assistant",
								"content": "∀ {K : Type u} {V : Type v} [inst : DivisionRing K] [inst_1 :
								AddCommGroup V] [inst_2 : Module K V] {ι : Type w}\n [inst_3 : Finite ι], Basis ι
								K V → FiniteDimensional K V"},
								...
								{"role": "user",
								"content": "If a vector space has dimension ‘2‘ then it is finite dimensional."}]
							  </code></pre>
					</li>

				</ul>
			</section>
			<section data-background-color="teal" class="language-lean">
				<ul>
					<li>Translation to Lean:
						If a vector space is $2$-dimensional, then it is finite dimensional.
						<pre><code data-trim data-noescape>
							theorem: ∀ {K : Type u} {V : Type v} 
							[inst : DivisionRing K] [inst_1 : AddCommGroup V] 
							[inst_2 : Module K V],
								Module.rank K V = 2 → FiniteDimensional K V
							  </code></pre>
					</li>
					<li class="fragment">This was one of our $40$ test <em>silly statements</em> (to avoid
						contamination).</li>
					<li class="fragment">We also had $40$ <em>theorems</em> and $40$ <em>false</em> statements in our
						test set. </li>
					<li class="fragment">On the test set of 120 example problems, we had a success rate of about 85%.
					</li>
				</ul>
				</ul>
			</section>


			<section data-background-color="teal">
				<h4>Better translation?</h4>
				<ul>
					<li class="fragment">However, the success rate of LeanAide was below 50% for the standard <em>ProofNet</em>
						dataset.</li>
					<li class="fragment">Causes of failure included:
						<ul>
							<li>
								Lean/Mathlib notation for integrals etc.
							</li>
							<li>
								Choice of terminology not matching Mathlib, e.g. <em>condensation points</em>
								versus <em>accumulation points</em>.
							</li>
						</ul>
					</li>
					<li class="fragment">We also need to translate statements whose target is a <em>block</em>, for
						which we need examples.</li>
					<li class="fragment">We can attempt to address these issues using GPT-4 for auxiliary tasks.</li>
				</ul>
			</section>
			<section>
				<h3>Iterative formalization</h3>
				<pre class="mermaid">
				  
					flowchart LR
					  P[(Problem)] --> reasoning[Reasoning by LLM]
					  reasoning --> pf[(Theorem and Proof)];
					  L[(Literature)] --> pf;
					  ans[(Notes/Answers)] --> ocr[OCR and formatting];
					  ocr --> pf;
					  pf --> |LLM|struct[(Structured JSON text)];
					  struct --> form[Autoformalization];
					  form --> lean[(Lean code)];
					  lean --> elab{Elaborate};
					  elab --> |Success|done((Done));
					  elab --> |Error|form;
					  elab --> |Sorries|P;
				  </pre>
			  </section>


			<section>
				<h3>Flowchart</h3>
				<pre class="mermaid">
				  
					flowchart LR
					  A[Start] --> B{Is it?};
					  B -- Yes --> C[OK];
					  X[Blah] --> C;
					  C --> D[Rethink];
					  D --> B;
					  B -- No ----> E[End];
				  </pre>
			  </section>


	</div>


	<script src="js/reveal.js"></script>

	<script>

		// Full list of configuration options available at:
		// https://github.com/hakimel/reveal.js#configuration
		Reveal.initialize({
			controls: true,
			progress: true,
			history: true,
			center: true,

			transition: 'slide', // none/fade/slide/concave/concave/zoom


			math: {
				mathjax: '../MathJax/MathJax.js',
				//				mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
				// mathjax: 'http://cdn.mathjax.org/mathjax/latest/MathJax.js',
				config: 'TeX-AMS_HTML-full' // See http://docs.mathjax.org/en/latest/config-files.html
			},
			mermaid: {
      // flowchart: {
      //   curve: 'linear',
      // },
    },

			// Optional reveal.js plugins
			dependencies: [
				{ src: 'lib/js/classList.js', condition: function () { return !document.body.classList; } },
				{ src: 'plugin/markdown/marked.js', condition: function () { return !!document.querySelector('[data-markdown]'); } },
				{ src: 'plugin/markdown/markdown.js', condition: function () { return !!document.querySelector('[data-markdown]'); } },
				//	{ src: '../highlight/highlight.pack.js', async: true, condition: function () { return !!document.querySelector('pre code'); }, callback: function () { hljs.initHighlightingOnLoad(); } },
				{ src: 'plugin/highlight/highlight.js', async: true },
				{ src: 'plugin/zoom-js/zoom.js', async: true },
				{ src: 'plugin/notes/notes.js', async: true },
				{ src: 'plugin/math/math.js', async: true }
			]
		});

		//			Reveal.addEventListener( 'slidechanged', function( event ) {
		//				MathJax.Hub.Rerender();
		//			} );

	</script>
	<script type="module">
		import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
		mermaid.initialize({ startOnLoad: true });
	  </script>

</body>

</html>